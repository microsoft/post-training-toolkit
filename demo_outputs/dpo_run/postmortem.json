{
  "exit_reason": "exception",
  "exit_code": null,
  "last_step": 20,
  "timestamp": "2025-12-14T06:00:37.909739+00:00",
  "traceback": "Traceback (most recent call last):\n  File \"/home/avasanthc/post-training-system/examples/minimal_dpo_demo.py\", line 201, in <module>\n    main()\n  File \"/home/avasanthc/post-training-system/examples/minimal_dpo_demo.py\", line 168, in main\n    trainer.train()\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 2240, in train\n    return inner_training_loop(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 2622, in _inner_training_loop\n    self._maybe_log_save_evaluate(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 3095, in _maybe_log_save_evaluate\n    metrics = self._evaluate(trial, ignore_keys_for_eval)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 3044, in _evaluate\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 4173, in evaluate\n    output = eval_loop(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py\", line 1509, in evaluation_loop\n    initial_output = super().evaluation_loop(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 4401, in evaluation_loop\n    self.control = self.callback_handler.on_prediction_step(args, self.state, self.control)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 552, in on_prediction_step\n    return self.call_event(\"on_prediction_step\", args, state, control)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 556, in call_event\n    result = getattr(callback, event)(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 659, in on_prediction_step\n    self.prediction_bar = tqdm(\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/asyncio.py\", line 24, in __init__\n    super().__init__(iterable, *args, **kwargs)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1098, in __init__\n    self.refresh(lock_args=self.lock_args)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1347, in refresh\n    self.display()\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1495, in display\n    self.sp(self.__str__() if msg is None else msg)\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 459, in print_status\n    fp_write('\\r' + s + (' ' * max(last_len[0] - len_s, 0)))\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 452, in fp_write\n    fp.write(str(s))\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/utils.py\", line 196, in inner\n    return func(*args, **kwargs)\nBrokenPipeError: [Errno 32] Broken pipe\n",
  "last_metrics": {
    "reward_mean": -1.3e-05,
    "reward_std": -4e-06,
    "dpo_loss": 0.6931,
    "win_rate": 0.75,
    "reward_margin": -4e-06,
    "logps_chosen": -124.347595,
    "logps_rejected": -35.185516,
    "logprobs": -124.347595,
    "rewards_chosen": -1.3e-05,
    "rewards_rejected": -9e-06
  },
  "recent_events": [
    "[2025-12-14T06:00:37.891330+00:00] exception: {'type': 'BrokenPipeError', 'message': '[Errno 32] Broken pipe', 'traceback': 'Traceback (most recent call last):\\n  File \"/home/avasanthc/post-training-system/examples/minimal_dpo_demo.py\", line 201, in <module>\\n    main()\\n  File \"/home/avasanthc/post-training-system/examples/minimal_dpo_demo.py\", line 168, in main\\n    trainer.train()\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 2240, in train\\n    return inner_training_loop(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 2622, in _inner_training_loop\\n    self._maybe_log_save_evaluate(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 3095, in _maybe_log_save_evaluate\\n    metrics = self._evaluate(trial, ignore_keys_for_eval)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 3044, in _evaluate\\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 4173, in evaluate\\n    output = eval_loop(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py\", line 1509, in evaluation_loop\\n    initial_output = super().evaluation_loop(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer.py\", line 4401, in evaluation_loop\\n    self.control = self.callback_handler.on_prediction_step(args, self.state, self.control)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 552, in on_prediction_step\\n    return self.call_event(\"on_prediction_step\", args, state, control)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 556, in call_event\\n    result = getattr(callback, event)(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/transformers/trainer_callback.py\", line 659, in on_prediction_step\\n    self.prediction_bar = tqdm(\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/asyncio.py\", line 24, in __init__\\n    super().__init__(iterable, *args, **kwargs)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1098, in __init__\\n    self.refresh(lock_args=self.lock_args)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1347, in refresh\\n    self.display()\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 1495, in display\\n    self.sp(self.__str__() if msg is None else msg)\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 459, in print_status\\n    fp_write(\\'\\\\r\\' + s + (\\' \\' * max(last_len[0] - len_s, 0)))\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/std.py\", line 452, in fp_write\\n    fp.write(str(s))\\n  File \"/home/avasanthc/.local/lib/python3.10/site-packages/tqdm/utils.py\", line 196, in inner\\n    return func(*args, **kwargs)\\nBrokenPipeError: [Errno 32] Broken pipe\\n'}"
  ],
  "environment": {
    "python_version": "3.10.12 (main, May 27 2025, 17:12:29) [GCC 11.4.0]",
    "platform": "Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.35",
    "hostname": "LAPTOP-L0UI3471",
    "pid": 10256,
    "torch_version": "2.7.1+cu126",
    "cuda_available": false,
    "transformers_version": "4.52.4",
    "trl_version": "0.18.2"
  },
  "cuda_error": null
}