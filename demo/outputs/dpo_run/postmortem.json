{
  "exit_reason": "exception",
  "exit_code": null,
  "last_step": 15,
  "timestamp": "2025-12-17T18:44:50.888403+00:00",
  "traceback": "Traceback (most recent call last):\n  File \"/Users/adityachallapally/Library/CloudStorage/OneDrive-Microsoft/Coding/post-training-toolkit/demo/scripts/minimal_dpo_demo.py\", line 201, in <module>\n    main()\n  File \"/Users/adityachallapally/Library/CloudStorage/OneDrive-Microsoft/Coding/post-training-toolkit/demo/scripts/minimal_dpo_demo.py\", line 168, in main\n    trainer.train()\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 2325, in train\n    return inner_training_loop(\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 2756, in _inner_training_loop\n    self._maybe_log_save_evaluate(\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3221, in _maybe_log_save_evaluate\n    metrics = self._evaluate(trial, ignore_keys_for_eval)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3170, in _evaluate\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 4513, in evaluate\n    self.log(output.metrics)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/trl/trainer/dpo_trainer.py\", line 1995, in log\n    return super().log(logs, start_time)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3793, in log\n    self.control = self.callback_handler.on_log(self.args, self.state, self.control, logs)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 549, in on_log\n    return self.call_event(\"on_log\", args, state, control, logs=logs)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 556, in call_event\n    result = getattr(callback, event)(\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 693, in on_log\n    self.training_bar.write(str(shallow_logs))\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 720, in write\n    with cls.external_write_mode(file=file, nolock=nolock):\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 117, in __enter__\n    return next(self.gen)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 745, in external_write_mode\n    inst.clear(nolock=True)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 1319, in clear\n    self.sp('')\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 459, in print_status\n    fp_write('\\r' + s + (' ' * max(last_len[0] - len_s, 0)))\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 452, in fp_write\n    fp.write(str(s))\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/utils.py\", line 196, in inner\n    return func(*args, **kwargs)\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 79, in inner\n    return func(*args, **kwds)\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/wandb/sdk/lib/console_capture.py\", line 171, in write_with_callbacks\n    n = orig_write(s)\nBrokenPipeError: [Errno 32] Broken pipe\n",
  "last_metrics": {
    "reward_mean": 1.2e-05,
    "reward_std": 2e-05,
    "dpo_loss": 0.6931,
    "win_rate": 0.75,
    "reward_margin": 2e-05,
    "logps_chosen": -108.302948,
    "logps_rejected": -56.844223,
    "logprobs": -108.302948,
    "rewards_chosen": 1.2e-05,
    "rewards_rejected": -8e-06
  },
  "recent_events": [
    "[2025-12-17T18:44:50.881393+00:00] exception: {'type': 'BrokenPipeError', 'message': '[Errno 32] Broken pipe', 'traceback': 'Traceback (most recent call last):\\n  File \"/Users/adityachallapally/Library/CloudStorage/OneDrive-Microsoft/Coding/post-training-toolkit/demo/scripts/minimal_dpo_demo.py\", line 201, in <module>\\n    main()\\n  File \"/Users/adityachallapally/Library/CloudStorage/OneDrive-Microsoft/Coding/post-training-toolkit/demo/scripts/minimal_dpo_demo.py\", line 168, in main\\n    trainer.train()\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 2325, in train\\n    return inner_training_loop(\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 2756, in _inner_training_loop\\n    self._maybe_log_save_evaluate(\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3221, in _maybe_log_save_evaluate\\n    metrics = self._evaluate(trial, ignore_keys_for_eval)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3170, in _evaluate\\n    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 4513, in evaluate\\n    self.log(output.metrics)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/trl/trainer/dpo_trainer.py\", line 1995, in log\\n    return super().log(logs, start_time)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer.py\", line 3793, in log\\n    self.control = self.callback_handler.on_log(self.args, self.state, self.control, logs)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 549, in on_log\\n    return self.call_event(\"on_log\", args, state, control, logs=logs)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 556, in call_event\\n    result = getattr(callback, event)(\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/transformers/trainer_callback.py\", line 693, in on_log\\n    self.training_bar.write(str(shallow_logs))\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 720, in write\\n    with cls.external_write_mode(file=file, nolock=nolock):\\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 117, in __enter__\\n    return next(self.gen)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 745, in external_write_mode\\n    inst.clear(nolock=True)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 1319, in clear\\n    self.sp(\\'\\')\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 459, in print_status\\n    fp_write(\\'\\\\r\\' + s + (\\' \\' * max(last_len[0] - len_s, 0)))\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/std.py\", line 452, in fp_write\\n    fp.write(str(s))\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/tqdm/utils.py\", line 196, in inner\\n    return func(*args, **kwargs)\\n  File \"/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py\", line 79, in inner\\n    return func(*args, **kwds)\\n  File \"/Users/adityachallapally/Library/Python/3.9/lib/python/site-packages/wandb/sdk/lib/console_capture.py\", line 171, in write_with_callbacks\\n    n = orig_write(s)\\nBrokenPipeError: [Errno 32] Broken pipe\\n'}"
  ],
  "environment": {
    "python_version": "3.9.6 (default, Oct 17 2025, 17:15:53) \n[Clang 17.0.0 (clang-1700.4.4.1)]",
    "platform": "macOS-26.1-arm64-arm-64bit",
    "hostname": "Adityas-MacBook-Pro.local",
    "pid": 55560,
    "torch_version": "2.8.0",
    "cuda_available": false,
    "transformers_version": "4.57.3",
    "trl_version": "0.24.0"
  },
  "cuda_error": null
}